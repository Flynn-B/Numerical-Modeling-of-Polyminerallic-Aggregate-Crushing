# Utilizing Dream3D to Export Data for DEM Simulation

DREAM3D-NX by BlueQuartz Software is a high level integrated environment to process, quantify, and represent microstructures. It is a stochastic based model with other general purpose applications. 

In this project, Dream3D will be used to segment voxel based models into STL files that will later be meshed with Gmsh into ASCII VTK files readable by LIGGGHTS for DEM analysis. 

The Dream3D pipelines included in this file allow exporting all clumps/clusters by mineral type. 

## Installation

Installation instructions are provided on the [Dream3D website](https://www.dream3d.io/Download/).

A license is needed, but students at academic institutions are provided a free yearly license. More found [here](https://www.dream3d.io/License/)

## Getting Started

Export `.npy` microstructure generated by MCRpy as a sequence of axial slice images using `ExportNPYforDream3D.py` found in MCRPY Scripts folder. Ensure Viridis color map is used in export. 

Open `3DImageStacktoDream3D2.d3dpipeline` `Dream3DtoSTL.d3dpipeline` using Dream3D, File -> Open Pipeline. 

Reconstruct microstructure in Dream3D using `3DImageStacktoDream3D2.d3dpipeline`.  Provide input file list in first filter, `Read Images[3D Stack] (ITK)`. Pipeline is designed for 4 phases, but can be expanded with more instances of filters `Multi-Threshold Objects` and `Replace Value in Array (Conditional)`.

Run the pipeline and feed the `.dream3d` file output into the second pipeline, `Dream3DtoSTL.d3dpipeline`. This pipeline will output a folder containing only the phase NOT selected (!=) in the second filter `Multi-Threshold Object`. Repeat for all phases/minerals to obtain a complete set of STL files.

## Post-Processing

Although useful in some circumstances, STL files are not easily readable by LIGGGHTS. Instead ASCII VTK files of UnstructuredGrid format are needed. 

`STLFoldertoVTK.py` is a simple script provided to do so. [Gmsh](https://gmsh.info/) is a required dependency in addition to Python packages gmsh, meshio, vtk. 

